<!DOCTYPE html>
<html lang="en">
  <head>
    <base href="../" />

    <title>Testing cookie consent</title>

    <link href="tests/test-style.css" rel="stylesheet">

    <link href="build/cookieconsent.min.css" rel="stylesheet">
  </head>

  <body role="document">

    <div class="example-window">
      <h1>Testing rectangular popups</h1>
      <p>Look at all the layouts on screen and see if any look wrong</p>

      <select id="theme">
        <option value="mono-floating">Mono</option>
        <option value="all-floating">Header / Close</option>
        <option value="centered-floating">Centered</option>
        <option value="custom-floating">Custom</option>
      </select>

      <select id="palette">
        <option value="blue">Blue</option>
        <option value="red">Red</option>
        <option value="black">Black</option>
      </select>

      <br><br>

      <button onclick="javascript: window.location = 'tests/test-2.html';">Next test</button>
    </div>

    <img src="https://files.slack.com/files-tmb/T02GS44MZ-F1Q2W5STX-5d7bf5c424/pasted_image_at_2016_07_08_05_34_pm_360.png" style="position:absolute;top:250px;left:0px;" />
    <img src="https://files.slack.com/files-tmb/T02GS44MZ-F1Q2W4BL7-f3efd7696f/pasted_image_at_2016_07_08_05_34_pm_360.png" style="position:absolute;top:250px;right:0px;" />
    <img src="https://files.slack.com/files-tmb/T02GS44MZ-F1Q373WCS-bb23c04895/pasted_image_at_2016_07_08_05_34_pm_360.png" style="position:absolute;bottom:250px;left:0px;" />
    <img src="https://files.slack.com/files-tmb/T02GS44MZ-F1Q2MU1KQ-73c6f891a2/pasted_image_at_2016_07_08_05_35_pm_360.png" style="position:absolute;bottom:250px;right:0px;" />

  </body>
</html>

<!--script src="../build/cookieconsent.min.js"></script-->
<script src="cookieconsent.js"></script>
<script>

  // this page tests a single theme against all it's options

  var themeSelector = document.getElementById('theme');
  var paletteSelector = document.getElementById('palette');

  var _popups = [];
  var _options = {
    theme: themeSelector[0].value,
    palette: paletteSelector[0].value,

    content: {
      cookieImage: 'http://plainicon.com/dboard/userprod/2921_4eb4c/prod_thumb/plainicon.com-64226-256px-fa8.png',
    },

    elements: {
      cookieImage: '<img class="cc-cookie-image" src="{children}" width="32px"/>',
    },

    customTheme: '{header}{message}{link}{close}{cookieImage}',
  };

  themeSelector.onchange = function (e) {
    _options.theme = e.target.value;
    run(_options);
  };

  paletteSelector.onchange = function (e) {
    _options.palette = e.target.value;
    run(_options);
  };

  run(_options);

  // ---------------------------------------------------------

  function run(commonOptions) {
    if (_popups.length) {
      callPopupMethod(_popups, 'destroy', []);
      _popups = [];
    }
    initPopups(_popups, commonOptions, [
      {type: 'dismiss', position: 'top-left'},
      {type: 'info',    position: 'top-right'},
      {type: 'opt-in',  position: 'bottom-left'},
      {type: 'opt-out', position: 'bottom-right'},
    ]);
  }

  function initPopups (popups, commonOpts, arrayOfOpts) {
    arrayOfOpts.forEach(function (opts) {
      var myOpts = Object.assign({}, commonOpts, opts);

      // so we don't end up with many wrappers, we'll make all cookie windows use the same wrapper
      if (popups.length) {
        myOpts.container = document.querySelector('.cc-wrapper');
        myOpts.useWrapper = false;
      }

      popups.push(cookieconsent.factory(myOpts));
    });
  }

  function callPopupMethod(popups, method, args) {
    return popups.map(function (popup) {
      return popup[method].apply(popup, args);
    });
  }

</script>
